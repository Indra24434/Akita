# CodeIgniter 4 Root .htaccess for Railway
RewriteEngine On

# Handle requests to public folder
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ public/$1 [L]

# Security: Block access to system folders
RewriteRule ^(app|system|writable|tests|\.env)($|/) - [F,L]

# Security: Block access to sensitive files
<Files ~ "^(\.env|\.htaccess|composer\.(json|lock)|\.git)">
    Order allow,deny
    Deny from all
</Files>

# For Railway PHP built-in server compatibility
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ public/index.php/$1 [L]
</IfModule>